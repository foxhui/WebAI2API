# 登录模式使用指南

## 三种登录模式

### 1. 图形界面登录模式 (`-login`)
**适用于：本地环境，有图形界面支持**

```bash
npm start -- -login
```

**特点：**
- 显示浏览器窗口
- 手动完成登录操作
- 适合首次使用和调试

**限制：**
- 容器环境无法使用（无图形界面）

### 2. 控制台登录模式 (`-login-console`)
**适用于：容器环境、无头环境、远程服务器**

```bash
npm start -- -login-console
```

**特点：**
- 无头模式运行
- 控制台输出登录指导
- 支持手机扫描二维码
- 支持验证码输入

**工作流程：**
1. 启动后自动导航到登录页面
2. 检测登录相关元素（二维码、验证码等）
3. 在控制台输出指导信息
4. 监控登录状态，提示登录成功

### 3. 默认模式（无参数）
**适用于：已登录状态，自动化运行**

```bash
npm start
```

**特点：**
- 使用已保存的登录会话
- 启用自动化程序
- 支持无头模式运行

## 控制台登录模式使用示例

### 在容器中使用
```bash
# 启动控制台登录模式
npm start -- -login-console
```

**控制台输出示例：**
```
2025-11-29 13:09:30.859 [INFO] [浏览器] 正在启动控制台登录模式...
2025-11-29 13:09:32.123 [INFO] [浏览器] 等待浏览器启动...
2025-11-29 13:09:35.456 [INFO] [浏览器] 正在导航到目标页面...
2025-11-29 13:09:38.789 [INFO] [登录助手] 开始监控登录流程...
2025-11-29 13:09:40.123 [INFO] [登录助手] 检测到 Google 登录页面
2025-11-29 13:09:40.124 [INFO] [登录助手] 请按照以下步骤操作：
2025-11-29 13:09:40.125 [INFO] [登录助手] 1. 输入您的 Google 账号
2025-11-29 13:09:40.126 [INFO] [登录助手] 2. 输入密码
2025-11-29 13:09:40.127 [INFO] [登录助手] 3. 如有需要，完成两步验证
2025-11-29 13:09:45.678 [INFO] [登录助手] 检测到二维码，请用手机扫描二维码完成登录
2025-11-29 13:10:15.789 [INFO] [登录助手] 检测到登录成功！
```

### 支持的登录方式检测
- **二维码扫描**：检测页面中的二维码元素，提示手机扫描
- **验证码输入**：检测验证码输入框，提示输入验证码
- **Google 登录**：自动识别 Google 登录页面，提供步骤指导
- **登录状态监控**：检测登录成功标志

## Docker 配置

### 登录模式配置
```dockerfile
# 控制台登录模式（推荐用于容器）
CMD ["npm", "start", "--", "-login-console"]

# 图形界面登录模式（仅本地测试）
CMD ["npm", "start", "--", "-login"]

# 默认模式（已登录状态）
CMD ["npm", "start"]
```

## 使用建议

### 首次使用
1. **本地环境**：使用 `-login` 模式完成首次登录
2. **容器环境**：使用 `-login-console` 模式完成首次登录

### 登录后
- 登录数据会保存在 `data/chromeUserData` 目录
- 后续使用默认模式即可自动复用登录会话
- 会话过期时重新使用登录模式

### 安全提示
- 登录模式会显示敏感信息，请在安全环境下使用
- 登录完成后及时切换回默认模式
- 定期检查登录会话状态